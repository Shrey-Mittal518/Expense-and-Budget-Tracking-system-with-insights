{% extends "base.html" %}

{% block title %}Online Sales{% endblock %}

{% block content %}
<div class="card">
    <h2>ğŸ›ï¸ Shop Online - Quick Access</h2>
    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 15px; margin-bottom: 30px;">
        <a href="https://www.amazon.in" target="_blank" style="text-align: center; padding: 20px; border: 2px solid #FF9900; border-radius: 4px; text-decoration: none; color: #333; display: block;">
            <div style="font-size: 36px; margin-bottom: 10px;">ğŸ›’</div>
            <div style="font-weight: bold;">Amazon</div>
        </a>
        <a href="https://www.flipkart.com" target="_blank" style="text-align: center; padding: 20px; border: 2px solid #2874F0; border-radius: 4px; text-decoration: none; color: #333; display: block;">
            <div style="font-size: 36px; margin-bottom: 10px;">ğŸ›ï¸</div>
            <div style="font-weight: bold;">Flipkart</div>
        </a>
        <a href="https://www.myntra.com" target="_blank" style="text-align: center; padding: 20px; border: 2px solid #FF3F6C; border-radius: 4px; text-decoration: none; color: #333; display: block;">
            <div style="font-size: 36px; margin-bottom: 10px;">ğŸ‘—</div>
            <div style="font-weight: bold;">Myntra</div>
        </a>
        <a href="https://www.swiggy.com" target="_blank" style="text-align: center; padding: 20px; border: 2px solid #FC8019; border-radius: 4px; text-decoration: none; color: #333; display: block;">
            <div style="font-size: 36px; margin-bottom: 10px;">ğŸ”</div>
            <div style="font-weight: bold;">Swiggy</div>
        </a>
        <a href="https://www.zomato.com" target="_blank" style="text-align: center; padding: 20px; border: 2px solid #E23744; border-radius: 4px; text-decoration: none; color: #333; display: block;">
            <div style="font-size: 36px; margin-bottom: 10px;">ğŸ•</div>
            <div style="font-weight: bold;">Zomato</div>
        </a>
        <a href="https://paytm.com" target="_blank" style="text-align: center; padding: 20px; border: 2px solid #00BAF2; border-radius: 4px; text-decoration: none; color: #333; display: block;">
            <div style="font-size: 36px; margin-bottom: 10px;">ğŸ’³</div>
            <div style="font-weight: bold;">Paytm</div>
        </a>
    </div>
</div>

<div class="card">
    <h2>ğŸ“¦ Your Online Purchases</h2>

    {% if sales %}
    <table>
        <thead>
            <tr>
                <th>Date</th>
                <th>Merchant</th>
                <th>Category</th>
                <th>Amount</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for sale in sales %}
            <tr>
                <td>{{ sale.date }}</td>
                <td>
                    {{ sale.merchant }}
                    <span style="background-color: #e3f2fd; color: #1976d2; padding: 2px 8px; border-radius: 3px; font-size: 11px; margin-left: 5px;">Online</span>
                </td>
                <td>{{ sale.category }}</td>
                <td style="color: #f44336; font-weight: bold;">
                    -â‚¹{{ "%.2f"|format(sale.amount|abs) }}
                </td>
                <td>
                    {% if 'amazon' in sale.merchant.lower() %}
                    <a href="https://www.amazon.in/orders" target="_blank" style="color: #1976d2; text-decoration: none;">View Order â†’</a>
                    {% elif 'flipkart' in sale.merchant.lower() %}
                    <a href="https://www.flipkart.com/account/orders" target="_blank" style="color: #1976d2; text-decoration: none;">View Order â†’</a>
                    {% else %}
                    <span style="color: #999;">-</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div style="background-color: #e3f2fd; padding: 15px; border-radius: 4px; margin-top: 20px;">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <div>
                <strong>Total Online Spending:</strong>
                <span style="font-size: 20px; font-weight: bold; color: #1976d2;">
                    â‚¹{{ "%.2f"|format(sales|sum(attribute='amount')|abs) }}
                </span>
            </div>
            <div style="color: #666; font-size: 14px;">{{ sales|length }} transactions</div>
        </div>
    </div>
    {% else %}
    <p class="text-center">No online sales detected yet.</p>
    <p class="text-center" style="color: #666; font-size: 14px; margin-top: 10px;">Transactions from Amazon, Flipkart, Myntra, Paytm, etc. will appear here automatically.</p>
    {% endif %}
</div>
{% endblock %}
